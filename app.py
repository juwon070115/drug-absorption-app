import streamlit as st
from sklearn.tree import DecisionTreeClassifier
import numpy as np

# μ‚¬μ΄λ“λ°”μ— λ¶€κ°€ μ •λ³΄ ν‘μ‹
st.sidebar.title("λ¶€κ°€ μ •λ³΄")

st.sidebar.markdown("""
### μ΅°κ±΄ μ„¤λ… λ° ν΅μ μ°¨μ΄ μ΄μ 

- **λ¶„μλ‰ (Molecular Weight)**  
  λ¶„μκ°€ ν΄μλ΅ μ„Έν¬λ§‰μ„ ν†µκ³Όν•κΈ° μ–΄λ µμµλ‹λ‹¤. λ”°λΌμ„ ν° λ¶„μλ” ν΅μκ°€ μ ν•λμ–΄ μ£Όλ΅ μ†μ¥μ΄λ‚ λ€μ¥μ—μ„ ν΅μλλ©°, μ‘μ€ λ¶„μλ” μ„μ—μ„λ„ μΌλ¶€ ν΅μκ°€ κ°€λ¥ν•©λ‹λ‹¤.

- **LogP (μ§€μ©μ„±)**  
  μ μ ν• μ§€μ©μ„±μ€ μ„Έν¬λ§‰ ν†µκ³Όμ— ν•„μμ…λ‹λ‹¤. λ„λ¬΄ λ‚®μΌλ©΄ μ§€μ©μ„±μ΄ λ¶€μ΅±ν•΄ ν¬κ³Όκ°€ μ–΄λ µκ³ , λ„λ¬΄ λ†’μΌλ©΄ μμ©μ„±μ΄ λ¶€μ΅±ν•΄ ν΅μμ— λ¶λ¦¬ν•©λ‹λ‹¤.

- **TPSA (κ·Ήμ„± ν‘λ©΄μ )**  
  κ·Ήμ„± ν‘λ©΄μ μ΄ ν¬λ©΄ λ¶„μκ°€ μμ©μ„±μ΄ λ†’μ•„μ§€μ§€λ§, μ„Έν¬λ§‰ ν†µκ³Όλ” μ–΄λ ¤μ›μ§‘λ‹λ‹¤. λ”°λΌμ„ TPSAκ°€ ν° μ•½λ¬Όμ€ μ£Όλ΅ μ†μ¥ κ°™μ€ ν¬κ³Όκ°€ μ©μ΄ν• λ¶€μ„μ—μ„ ν΅μλ©λ‹λ‹¤.

- **pKa (μ΄μ¨ν™” pH κ°’)**  
  μ•½λ¬Όμ μ΄μ¨ν™” μ •λ„λ” μ²΄λ‚΄ λ¶€μ„λ³„ pHμ— λ”°λΌ λ‹¬λΌμ§‘λ‹λ‹¤. μ΄μ¨ν™”λ μƒνƒλ” μ„Έν¬λ§‰ ν¬κ³Όκ°€ μ–΄λ µκΈ° λ•λ¬Έμ—, pKa κ°’κ³Ό μ²΄λ‚΄ pH μ°¨μ΄μ— λ”°λΌ ν΅μλλ” μ„μΉκ°€ λ‹¬λΌμ§‘λ‹λ‹¤.

---

### ν΅μ μ„μΉλ³„ νΉμ§•

- **μ„ (Stomach)**  
  μ‚°μ„± ν™κ²½μ΄λ©° μ λ§‰μ΄ λ‘κΊΌμ› ν΅μκ°€ μ ν•μ μ…λ‹λ‹¤. μ‘μ€ λ¶„μμ™€ νΉμ • μ΄μ¨ν™” μƒνƒμ μ•½λ¬Όμ΄ μΌλ¶€ ν΅μλ©λ‹λ‹¤.

- **μ†μ¥ (Small Intestine)**  
  λ„“κ³  μ–‡μ€ μ λ§‰μΌλ΅ ν΅μμ— κ°€μ¥ μ λ¦¬ν• μ¥μ†μ…λ‹λ‹¤. λ€λ¶€λ¶„μ μ•½λ¬Όμ΄ μ΄κ³³μ—μ„ ν΅μλ©λ‹λ‹¤.

- **λ€μ¥ (Large Intestine)**  
  μ£Όλ΅ μλ¶„ ν΅μκ°€ μ΄λ£¨μ–΄μ§€λ©°, μΌλ¶€ μ§€μ©μ„± μ•½λ¬Όμ΄ ν΅μλ©λ‹λ‹¤.
""")

# ν•™μµ λ°μ΄ν„°
X_train = [
    [151, 0.5, 49, 4.5],
    [206, 2.1, 20, 5.2],
    [180, -0.9, 78, 3.8],
    [296, 3.0, 40, 7.0],
    [260, 1.5, 58, 6.3],
    [194, -1.2, 95, 3.1],
    [320, 2.8, 32, 6.8],
    [180, 0.0, 44, 4.2],
    [210, 2.3, 30, 5.0],
    [230, 1.8, 50, 4.7],
    [250, 3.1, 25, 6.0],
    [190, -1.0, 80, 3.5],
    [300, 2.5, 35, 7.2],
    [220, 1.3, 45, 5.8],
    [270, 2.9, 38, 6.5],
    [160, -0.5, 55, 4.0],
    [200, 0.7, 60, 5.1],
    [280, 3.4, 40, 6.7],
    [240, 1.6, 50, 5.6],
    [195, -1.1, 70, 3.4],
    [310, 2.7, 33, 6.9],
    [185, 0.3, 48, 4.3],
    [215, 2.0, 29, 5.3],
    [225, 1.9, 52, 4.8],
    [255, 3.2, 27, 6.1],
    [192, -0.8, 78, 3.6],
    [305, 2.6, 36, 7.1],
    [225, 1.4, 44, 5.7],
    [275, 3.0, 39, 6.4],
    [165, -0.6, 53, 4.1],
]

y_train = [
    1,0,2,1,1,2,0,1,0,1,0,2,1,0,1,
    2,1,0,1,2,0,1,0,1,0,2,1,0,1,2
]

# λ¨λΈ ν•™μµ
model = DecisionTreeClassifier(random_state=42)
model.fit(X_train, y_train)

st.title("π’ μ•½λ¬Ό ν΅μ μ„μΉ μμΈ΅κΈ° (AI κΈ°λ°)")
st.write("λ¶„μ νΉμ„±μ„ μ…λ ¥ν•λ©΄ μ•½λ¬Όμ΄ μ£Όλ΅ ν΅μλλ” μ‹ μ²΄ λ¶€μ„λ¥Ό μμΈ΅ν•©λ‹λ‹¤.")

mw = st.number_input("π“¦ λ¶„μλ‰ (Molecular Weight)", min_value=50.0, max_value=1000.0, step=1.0)
logp = st.number_input("π’§ LogP (μ§€μ©μ„±)", min_value=-5.0, max_value=10.0, step=0.1)
tpsa = st.number_input("π§ κ·Ήμ„± ν‘λ©΄μ  (TPSA)", min_value=0.0, max_value=200.0, step=1.0)
pka = st.number_input("π§¬ pKa (μ΄μ¨ν™” μƒμ)", min_value=0.0, max_value=14.0, step=0.1)

def predict_absorption_site(mw, logp, tpsa, pka):
    input_data = np.array([[mw, logp, tpsa, pka]])
    prediction = model.predict(input_data)[0]
    site_map = {0: "μ„", 1: "μ†μ¥", 2: "λ€μ¥"}
    return site_map[prediction]

if st.button("μμΈ΅ν•κΈ°"):
    site = predict_absorption_site(mw, logp, tpsa, pka)
    st.success(f"β… μ΄ μ•½λ¬Όμ€ **'{site}'**μ—μ„ ν΅μλ  κ°€λ¥μ„±μ΄ λ†’μµλ‹λ‹¤.")
